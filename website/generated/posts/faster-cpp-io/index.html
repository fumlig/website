<!doctype html>
<html lang="en">


<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Oskar Lundin">
<meta name="description" content="Some tricks for faster C++ input and output.">
<meta name="theme-color" content="#204A87">
<meta property="og:site_name" content="oskarlundin.com">
<meta property="og:title" content="Faster C++ I/O for Competitive Programming :: oskarlundin.com">
<meta property="og:url" content="https://www.oskarlundin.com/posts/faster-cpp-io/">
<meta property="og:description" content="Some tricks for faster C++ input and output.">


<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-08-28">
<meta property="article:modified_time" content="2019-08-31">
<meta property="article:author" content="Oskar Lundin">
<meta property="article:section" content="Technology">
<meta property="article:tag" content="c++">

<meta property="article:tag" content="test tag">
<title>
Faster C++ I/O for Competitive Programming :: oskarlundin.com
</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="stylesheet" type="text/css" href="/css/content.css">
<link rel="stylesheet" type="text/css" href="/css/post.css">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-145117300-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-145117300-1');
</script>
</head>


<body>

<header>
<p style="text-align: center">Site under construction</p>
<a id="logo" href="/"><img src="/images/logo.svg">oskarlundin.com</a>
<nav>
<a href="/">home</a> ::
<a href="/posts/">posts</a> ::
<a href="/about/">about</a>
</nav>
</header>

<main>
<article class="post">
<h1 class="post-title">Faster C++ I/O for Competitive Programming</h1>
<p class="post-created">Created: <time>2019-08-28</time></p>
<p class="post-modified">Modified: <time>2019-08-31</time></p>
<p class="post-tags">Tags: c++, test tag</p>
<p class="post-description">Some tricks for faster C++ input and output.</p>
<div class="post-content"><p>Complete header file with all functions.</p>
<pre class="codehilite"><code class="language-cpp">///
/// \file io.h
/// \brief IO functions
///
/// Functions for IO, focused on speed. This is achieved by specializing each
/// function for the type it works with.
///
/// \author Oskar Lundin (olundin)
///

#include &lt;cstdio&gt;

#ifdef _WIN32
#define O_GETCHAR() _getchar_nolock()
#define O_PUTCHAR(c) _putchar_nolock(c)
#endif
#ifdef __linux__
#define O_GETCHAR() getchar_unlocked()
#define O_PUTCHAR(c) putchar_unlocked(c)
#endif

namespace o {

///
/// \brief Scans a character from stdin
/// \return The character scanned from stdin
///
inline char get_char() {
  return O_GETCHAR();
}

///
/// \brief Appends a character to stdout
/// \param c The character to append to stdout
///
inline void put_char(char c) {
  O_PUTCHAR(c);
}


///
/// \brief Scans an integer from stdin
///
/// Scans an integer from standard input (stdin). Assumes that the integer
/// is at the beginning of the input stream, with no whitespaces before it.
/// Stops scanning when a character which isn't a number is encountered. This
/// character is removed from the stream.
///
/// \tparam T Integer type (must be either char, int, short or long)
/// \return The integer scanned
///
template &lt;typename T&gt;
inline T scan_int() {
  T n = 0;
  bool negative = false;
  char c = get_char();
  // check if negative
  if(c == '-') {
    negative = true;
    c = get_char();
  }
  // scan digits
  do {
    n = n * 10 + c - '0';
    c = get_char();
  } while(c &gt;= '0' &amp;&amp; c &lt;= '9');
  // negate if negative
  if(negative)
    n = -n;
  return n;
}
/// Explicit instantiation of scan_int for type int
template int scan_int&lt;int&gt;();

///
/// \brief Tries to scan an integer from stdin
///
/// Tries to scan an integer from standard input (stdin). If the first
/// character is not a number, it will stop scanning and return false.
/// Otherwise, the scan is continued until a character which isn't a number is
/// encountered. This character is removed from the stream and the function
/// returns true.
///
/// \tparam T Integer type (must be either char, int, short or long)
/// \param n The integer to set
/// \return True if the scan was successful, else false
///
template &lt;typename T&gt;
inline bool try_scan_int(T&amp; n) {
  char c = get_char();
  if(c &lt; '0' || c &gt; '9')
    return false;
  ungetc(c, stdin);
  n = scan_int&lt;T&gt;();
  return true;
}

/// Explicit instantiation of scan_int_check for type int
template bool try_scan_int&lt;int&gt;(int&amp;);

///
/// \brief Prints an integer to stdout
/// \tparam T Integer type (must be either char, int, short or long)
/// \tparam N Maximum number of digits in integer
/// \param n The integer to print
///
template&lt;typename T, size_t N&gt;
inline void print_int(T n) {
  if(n == 0) {
    put_char('0');
  } else {
  // check if negative
    if(n &lt; 0) {
      put_char('-');
      n = -n;
    }
    // max number of digits is N
    char buffer[N];
    int i = N - 1;
    // scan digits and store
    while(n) {
      buffer[i--] = n % 10 + '0';
      n /= 10;
    }
    // print each digit
    while(i != N - 1) {
      put_char(buffer[++i]);
    }
  }
}
/// Explicit instantiation of scan_int_check for type int
template void print_int&lt;int, 10&gt;(int);

///
/// \brief Scans a string from stdin
///
/// Scans a string standard input (stdin) until the delimiter \p d is reached.
/// If the first character in stdin is EOF, the function stops scanning and
/// returns false. Otherwise characters are stored in \p s until the delimiter
/// is encountered and true is returned.
///
/// \param s String to fill with characters
/// \return True if the scan was successful, else false
///
inline bool scan(char* s, char d = ' ') {
  char c = get_char();
  if(c == EOF)
    return false;
  int index = 0;
  do {
    s[index++] = c;
    c = get_char();
  } while(c != d);
}

///
/// \brief Scans an entire line from stdin
///
/// Calls \ref scan &quot;scan(s, '\n')&quot;.
///
/// \param s String to fill with characters
/// \return True if the scan was successful, else false
///
inline bool scanln(char* s) {
  return scan(s, '\n');
}

///
/// \brief Prints a string to stdout
/// \param s String to print
///
inline void print(const char* s) {
    int c = 0;
    while(s[c] != '\0')
        put_char(s[c++]);
}

///
/// \brief Prints a string to stdout and end line
/// \param s String to print
///
inline void println(const char* s) {
    print(s);
    put_char('\n');
}

}</code></pre>


<p>Ending text.</p></div>
</article>
</main>

<footer>
<a href="https://git.oskarlundin.com/oskar/website">source</a> ::
<a href="https://git.oskarlundin.com">git</a> ::
<a href="https://files.oskarlundin.com">files</a> ::
<a href="mailto:c.oskar.lundin@gmail.com">mail</a>
<br>
&copy; Copyright 2019 Oskar Lundin
</footer>

</body>


</html>
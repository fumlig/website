<!doctype html>
<html lang="en">


<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Oskar Lundin">
<meta name="description" content="Some tricks for faster C++ input and output.">
<meta name="theme-color" content="#204A87">
<meta property="og:site_name" content="oskarlundin.com">
<meta property="og:title" content="Faster C++ I/O :: oskarlundin.com">
<meta property="og:uri" content="https://www.oskarlundin.com/posts/faster-cpp-io/">
<meta property="og:description" content="Some tricks for faster C++ input and output.">


<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-08-28">
<meta property="article:modified_time" content="2019-09-01">
<meta property="article:author" content="Oskar Lundin">
<meta property="article:section" content="Technology">
<meta property="article:tag" content="c">

<meta property="article:tag" content="c++">

<meta property="article:tag" content="competitive programming">
<title>
Faster C++ I/O :: oskarlundin.com
</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="stylesheet" type="text/css" href="/css/content.css">
<link rel="stylesheet" type="text/css" href="/css/post.css">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-145117300-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-145117300-1');
</script>
</head>


<body>

<header>
<a id="logo" href="/"><img src="/images/logo.svg">oskarlundin.com</a>
<nav>
<a href="/">home</a> ::
<a href="/posts/">posts</a> ::
<a href="/about/">about</a>
</nav>
</header>

<main>
<article class="post">
<h1 class="post-title">Faster C++ I/O</h1>
<p class="post-created">Created: <time>2019-08-28</time></p>
<p class="post-modified">Modified: <time>2019-09-01</time></p>
<p class="post-tags">Tags: c, c++, competitive programming</p>
<p class="post-description">Some tricks for faster C++ input and output.</p>
<div class="post-content"><div class="toc"><span class="toctitle">Contents</span><ul>
<li><a href="#different-io-alternatives">Different I/O Alternatives</a><ul>
<li><a href="#stdcin-and-stdcout">std::cin and std::cout</a><ul>
<li><a href="#disable-synchronization">Disable Synchronization</a></li>
<li><a href="#untying-stdcin-from-stdcout">Untying std::cin from std::cout</a></li>
</ul>
</li>
<li><a href="#scanf-and-printf">scanf() and printf()</a></li>
<li><a href="#getchar-and-putchar">getchar() and putchar()</a><ul>
<li><a href="#unlocked">Unlocked</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>
<h2 id="different-io-alternatives">Different I/O Alternatives<a class="headerlink" href="#different-io-alternatives" title="Permanent link">&para;</a></h2>
<h3 id="stdcin-and-stdcout">std::cin and std::cout<a class="headerlink" href="#stdcin-and-stdcout" title="Permanent link">&para;</a></h3>
<p>Using <code>&lt;iostream&gt;</code>Â´s <code>std::cin</code> and <code>std::cout</code> is the preferred way to handle
input and output in C++. It's type-safe and extensible, but all of this comes
at a cost. Let's look at an example program.</p>
<div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">d</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">d</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Compiling this program with g++ version 9.10 and 1 000 000 randomized integers
between -10 000 and 10 000 as input takes 0,539 seconds.</p>
<table>
<thead>
<tr>
<th>I/O Alternative</th>
<th>Time (s)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>std::cin</code> and <code>std::cout</code></td>
<td>0,539</td>
</tr>
</tbody>
</table>
<p>This doesn't seem half bad but we can do better!</p>
<h4 id="disable-synchronization">Disable Synchronization<a class="headerlink" href="#disable-synchronization" title="Permanent link">&para;</a></h4>
<p>The C and C++ standard streams are per default synchronized. This allows you to
mix C- and C++-style I/O and get deterministic results. However, if you are
sure that you won't use C-style I/O, you can disable this synchronization. This
can lead to an improvement in performance.</p>
<p>To disable synchronization, add following line to your program:</p>
<div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
<span class="hll">    <span class="n">std</span><span class="o">::</span><span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">d</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">d</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>This brings the program runtime down to 0,421 seconds.</p>
<table>
<thead>
<tr>
<th>I/O Alternative</th>
<th>Time (s)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>std::cin</code> and <code>std::cout</code>, synchronization disabled</td>
<td>0,421</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code></td>
<td>0,539</td>
</tr>
</tbody>
</table>
<h4 id="untying-stdcin-from-stdcout">Untying <code>std::cin</code> from <code>std::cout</code><a class="headerlink" href="#untying-stdcin-from-stdcout" title="Permanent link">&para;</a></h4>
<p>One additional trick is to untie <code>std::cin</code> from <code>std::cout</code>. Tied streams
ensure that one stream is flushed before any I/O operations on the other.
It is possible to untie the two streams with the following function call:</p>
<div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
<span class="hll">    <span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">d</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">d</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Running this program takes 0,100 seconds, which is a massive improvement.</p>
<table>
<thead>
<tr>
<th>I/O Alternative</th>
<th>Time (s)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>std::cin</code> and <code>std::cout</code>, untied</td>
<td>0,100</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code>, synchronization disabled</td>
<td>0,421</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code></td>
<td>0,539</td>
</tr>
</tbody>
</table>
<h3 id="scanf-and-printf">scanf() and printf()<a class="headerlink" href="#scanf-and-printf" title="Permanent link">&para;</a></h3>
<p>The C standard library provides the <code>scanf()</code> and
<code>printf()</code> functions. These are more primitive and less
safe than C++'s <code>std::cin</code> and <code>std::cout</code> but usually quite a lot faster.</p>
<div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="cp">#define N 1000000</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">d</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Compiled with gcc version 9.10 and ran with the same input as previous
programs, this takes 0,141 seconds.</p>
<table>
<thead>
<tr>
<th>I/O Alternative</th>
<th>Time (s)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>std::cin</code> and <code>std::cout</code>, untied</td>
<td>0,100</td>
</tr>
<tr>
<td><code>scanf()</code> and <code>printf()</code></td>
<td>0,141</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code>, synchronization disabled</td>
<td>0,421</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code></td>
<td>0,539</td>
</tr>
</tbody>
</table>
<p>So, are <code>std::cin</code> and <code>std::cout</code> unsynchronized and untied still the winners?
No - we can do better!</p>
<h3 id="getchar-and-putchar">getchar() and putchar()<a class="headerlink" href="#getchar-and-putchar" title="Permanent link">&para;</a></h3>
<p><code>getchar()</code> and <code>putchar()</code> are the most primitive I/O functions in the C
standard library. They are used to get and put individual characters from and
to <code>stdin</code> and <code>stdout</code>.</p>
<p>We can take advantage of these to write our own even faster I/O functions:</p>
<div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdbool.h&gt;</span><span class="cp"></span>

<span class="cp">#define N 1000000</span>
<span class="cp">#define MAX_DIGITS 7 </span><span class="c1">// 7 digits in 1 000 000</span>

<span class="kt">int</span> <span class="nf">scanint</span><span class="p">()</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">negative</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>

    <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;-&#39;</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">negative</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">do</span> 
    <span class="p">{</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
    <span class="p">}</span> 
    <span class="k">while</span><span class="p">(</span><span class="n">c</span> <span class="o">&gt;=</span> <span class="sc">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;9&#39;</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span><span class="n">negative</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">n</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">printint</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;0&#39;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;-&#39;</span><span class="p">);</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">MAX_DIGITS</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">MAX_DIGITS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">+</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
        <span class="n">n</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">MAX_DIGITS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">putchar</span><span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="o">++</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="n">scanint</span><span class="p">();</span>
        <span class="n">printint</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>How long does this take to run? 0,074 seconds.</p>
<table>
<thead>
<tr>
<th>I/O Alternative</th>
<th>Time (s)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getchar()</code> and <code>putchar()</code></td>
<td>0,074</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code>, untied</td>
<td>0,100</td>
</tr>
<tr>
<td><code>scanf()</code> and <code>printf()</code></td>
<td>0,141</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code>, synchronization disabled</td>
<td>0,421</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code></td>
<td>0,539</td>
</tr>
</tbody>
</table>
<h4 id="unlocked">Unlocked<a class="headerlink" href="#unlocked" title="Permanent link">&para;</a></h4>
<p>As it happens, there is one more trick we can use. Both <code>getchar()</code> and
<code>putchar()</code> are thread safe which is generally preferrable. If one really wants
the fastest possible I/O there are so called unlocked versions of <code>getchar()</code>
and <code>putchar()</code>.</p>
<p>On POSIX systems, these are defined as <code>getchar_unlocked()</code> and
<code>putchar_unlocked()</code>. On Windows systems, they are defined as
<code>_getchar_nolock()</code> and <code>_putchar_nolock()</code>. Let's use these in our custom I/O
functions.</p>
<div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdbool.h&gt;</span><span class="cp"></span>

<span class="cp">#define N 1000000</span>
<span class="cp">#define MAX_DIGITS 7 </span><span class="c1">// 7 digits in 1 000 000</span>

<span class="cp">#ifdef _WIN32</span>
<span class="cp">#define GETCHAR() _getchar_nolock()</span>
<span class="cp">#define PUTCHAR(c) _putchar_nolock(c)</span>
<span class="cp">#elif __unix__</span>
<span class="cp">#define GETCHAR() getchar_unlocked()</span>
<span class="cp">#define PUTCHAR(c) putchar_unlocked(c)</span>
<span class="cp">#else</span>
<span class="cp">#define GETCHAR() getchar()</span>
<span class="cp">#define PUTCHAR(c) putchar(c)</span>
<span class="cp">#endif</span>

<span class="kt">int</span> <span class="nf">scanint</span><span class="p">()</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">negative</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="n">GETCHAR</span><span class="p">();</span>

    <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;-&#39;</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">negative</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">GETCHAR</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">do</span> 
    <span class="p">{</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">GETCHAR</span><span class="p">();</span>
    <span class="p">}</span> 
    <span class="k">while</span><span class="p">(</span><span class="n">c</span> <span class="o">&gt;=</span> <span class="sc">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;9&#39;</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span><span class="n">negative</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">n</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">printint</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">PUTCHAR</span><span class="p">(</span><span class="sc">&#39;0&#39;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">PUTCHAR</span><span class="p">(</span><span class="sc">&#39;-&#39;</span><span class="p">);</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">MAX_DIGITS</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">MAX_DIGITS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">+</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
        <span class="n">n</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">MAX_DIGITS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">PUTCHAR</span><span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="o">++</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="n">scanint</span><span class="p">();</span>
        <span class="n">printint</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>This new program takes 0,055 seconds which makes it the fastest yet.</p>
<table>
<thead>
<tr>
<th>I/O Alternative</th>
<th>Time (s)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getchar()</code> and <code>putchar()</code>, unlocked</td>
<td>0,055</td>
</tr>
<tr>
<td><code>getchar()</code> and <code>putchar()</code></td>
<td>0,074</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code>, untied</td>
<td>0,100</td>
</tr>
<tr>
<td><code>scanf()</code> and <code>printf()</code></td>
<td>0,141</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code>, synchronization disabled</td>
<td>0,421</td>
</tr>
<tr>
<td><code>std::cin</code> and <code>std::cout</code></td>
<td>0,539</td>
</tr>
</tbody>
</table>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>So, how should you do I/O? Usually, just use <code>std::cout</code> and <code>std::cin</code> or
<code>scanf()</code> and <code>printf()</code> as they are safe and easy to use. If you need to
squeeze out performance you can, in very specific cases use the tricks
mentioned in this article.</p></div>
</article>
</main>

<footer>
<a href="https://git.oskarlundin.com/oskar/website">source</a> ::
<a href="https://git.oskarlundin.com">git</a> ::
<a href="https://files.oskarlundin.com">files</a> ::
<a href="mailto:c.oskar.lundin@gmail.com">mail</a>
<br>
&copy; Copyright 2019 Oskar Lundin
</footer>

</body>


</html>